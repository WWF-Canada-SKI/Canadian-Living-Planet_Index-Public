# Canadian Living Planet Index
The Living Planet Index — a biodiversity indicator that assesses the relative change of aggregate vertebrate abundance data — is an indicator used in global (e.g., Kunming Montreal Global Biodiversity Framework) and national (e.g., Canada’s 2030 Nature Strategy) biodiversity monitoring frameworks. In Canada, the LPI has been modified (C-LPI) — adopting differing methodological choices relative to the global LPI. However, there is no clear consensus on the most appropriate analytical methods, particularly as they pertain to the treatment of zeros, credible intervals and uncertainty, time series length and number of data points required, modelling of short time series, removal of outliers, weighting species, and the impact of baseline year selection. Our analysis transparently explores multiple methodological options for each of these decision points. Our research does not evaluate the superiority of a single approach but rather reinforces the need for transparency and accountability in reporting. We hope that the transparency provided in this study will further strengthen the utility of the C-LPI and provide decision makers with the necessary information to appropriately interpret patterns, evaluate progress, and inform conservation action. 

Title: Navigating methodological decisions: Balancing rigor and data volume of the Canadian Living Planet Index
Authors: Jessica Currie1, Sarah M Ravoth, Valentina Marconi, Louise McRae, Maria I Arce-Plata, Sandra Emry, Robin Freeman, Maximiliane Jousse, Gaëlle Mével, Shuaishuai Li, Cristian A Cruz-Rodríguez, David AGA Hunt, Philippa Oppenheimer, Lauren Gill, Janaina Serrano, Stefanie Deinet 



## Scripts
The attached code permits calculation of the Canadian Living Planet Index (synonomous with Environment and Cliamte Change Canada's "Canadian Species Index"). Note that confidential records (those deemed confidential by the data contributor) have been removed in the dataset, and thus results will not align perfectly. 

The code differs from the global Living Planet Index in a variety of ways including assignmnet of replicates, treatment of zeroes, modelling, credible intervals, and weightings. Consequently, when running an analysis for Canada, it may be best to begin with this code, which uses the original _rlpi_ package. 


We showcase the impact of methodological decisions associated with seven parameters on the C-LPI: (i) treatment of zero values, (ii) credible intervals and uncertainty, (iii) time series length and number of data points, (iv) modelling of short time series, (v) removal of outliers, (vi) weighting of species, and (vii) selection of the baseline year. Methodological changes were compared to current approaches employed by the C-LPI (Table 1). Native vertebrate trends were calculated predominantly using selectable options under the publicly available rlpi R package (Freeman et al. 2017), with indices spanning from 1970 to 2022. 

(i) Treatment of zero values
Mathematically, population counts of zero pose a problem within the calculation of the LPI, as all values are logged in the process of calculating the geometric mean. Consequently, all population counts of zero must be replaced. The current C-LPI approach is to treat zeros as missing values (referenced as NA (C-LPI) — in line with recommendations on the calculation of the index (Toszogyova et al. 2024). This decision was based on close investigation of the time series in the dataset, which were deemed to be more often missing observations rather than representations of extirpation (Marconi et al. 2021). Here, we explore six alternatives:
a.	+1% mean: Adding 1% of the mean of the time series to all zero values within the time series (this approach is currently adopted by the global LPI; Collen et al. 2009).
b.	+minimum: Adding the minimum non-zero value of the time series to all zero values.
c.	+1: Adding 1 to all values within the time series containing zeros.
d.	+0.000001: Adding a small value (0.000001) to all zeros.
e.	NA, NA, +1% mean: Conditionally replacing zero values depending on their position in the time series. Leading zeros (i.e., those at the beginning of the population time series) and zeros located in the middle (i.e., those with >0 values in years before and after the zero value) are treated as missing values, while trailing zeros (i.e., those at the end of the population time series) are kept (by adding 1% of the mean, as in a) on the assumption that they might represent local extirpations.
f.	+1% mean, NA, +1% mean: Conditionally replacing zero values depending on their position in the time series. Leading zeros and trailing zeros are kept by adding 1% of the mean, on the assumption that they might represent, respectively, recolonizations and local extirpations, while zeros located in the middle are treated as missing values.

**Options a-d are available in the rlpi package, while options e and f are novel explorations. 

(ii) Credible intervals and uncertainty
Ideally, uncertainty would be propagated up from each population, but information on uncertainty for individual population counts is not included in the database and often differs among sources. Consequently, credible intervals here reflect the range of LPI values that can fit into the existing data, capturing the variability within the dataset rather than the true variability associated with population counts, which would be reflected within a typical confidence interval. The C-LPI presents 95% credible intervals calculated from bootstrapping logged interannual change values (“lambdas” hereafter) with replacement within species and produces a value for each of the 10,000 bootstrapped resamples. This approach aims to account for autocorrelations in lambdas over time for a given species. Here, we explore two alternatives using 10,000 bootstrap samples:
a.	Adopting the global LPI default setting in the rlpi package (Freeman et al. 2017) to calculate credible intervals around LPI trends by bootstrapping lambdas within a year and taking the 95% central values to construct the credible interval values for that year. This approach was used by Collen et al. (2009), where bootstrapping was conducted by randomly sampling species for each year, independently, which did not account for autocorrelations in lambdas over time for a given species.
b.	Bootstrapping lambdas within a population and re-averaging at the species level to produce 95% credible intervals for the 10,000 bootstrapped resamples. This approach aims to account for autocorrelations in lambdas over time for a given population. 

**Option a is available in the rlpi package, while option b is a novel exploration. Note that the credible intervals for all options are multiplicative and increase in width over time as the uncertainty of previous years is inherited by the rest of the trend. 

(iii) Time series length and number of data points
C-LPI data were collected from a variety of sources, which report on diverse species and geographies and are collected via different methodologies. Consequently, population time series vary in the number of data points (total number of years with non-null values), length (duration of time series from first to last year with non-null values), and completeness (number of data points divided by time period covered). In addition, there is no extrapolation beyond the start and end point of a time series, and thus each population time series enters the C-LPI at different points in time. Previous research has suggested that lower-quality population time series (measured via length, number of data points and spatial coverage) diverge from average trends in higher-quality data and often exhibit more negative indices (Toszogyova et al. 2024; Marconi et al. 2021). The C-LPI requires three data points between 1970 and the end point of the index (currently 2022) but does not set criteria for length or completeness. Thus, we explore three alternatives for the required number of data points:
a.	Requirement of two or more data points as the global LPI approach of the rlpi package (Freeman et al. 2017) in alignment with Collen et al. 2009.
b.	Requirement of six or more data points, in recognition that generalized additive models (GAM) can be applied to population time series with six or more data points, compared with those with fewer points (where instead, log-linear interpolation or linear regression are adopted; Marconi et al. 2021; Collen et al. 2009; Loh et al. 2005) (see section (iv) Modelling of short time series below). 
c.	Requirement of 15 or more data points to showcase the impact of longer time series.

Additionally, as there are no set criteria for length or completeness, we explored:
a.	Four time series lengths (duration of time series from first to last year with non-null values) at equal intervals: a) ≥5 years, b) ≥10 years, c) ≥15 years, d) ≥20 years. 
b.	Four time series completeness at equal intervals: a) >0%, b) >25%, c) >50%, and d) >75%.

(iv) Modelling of short time series
Changes in population abundance are calculated by the geometric mean of relative abundance from 1970 to 2022, though modelling approaches to interpolate annual values between the start and end point of a time series differ, depending on the number of data points. We used Generalized Additive Models (GAMs) to allow for a smoothed trend, rather than linear format (Wood 2017; Buckland et al. 2005) for population time series with six or more data points. GAMs permit interpolation for all years between the start and end years of the population time series. However, GAMs are less efficient with fewer data, and in some cases are not appropriate. Consequently, we apply alternative approaches for population time series with less than six data points or those with poor GAM fitness. The C-LPI uses linear regression models for time series with less than 6 data points. Here, we explore two alternatives for population time series where GAMs are not applied:
a.	Log-linear interpolation, which is the global LPI default approach of the rlpi package (Freeman et al. 2017) in alignment with Collen et al. 2009 and Loh et al. 2005.
b.	Forcing a GAM on short time series, as a numeric requirement for data points has not been identified.

(v) Removal of outliers
While a geometric mean of relative abundance is considered a suitable and sensitive metric to assess biodiversity change (Santini et al. 2017; van Strien et al. 2012), it is nevertheless sensitive to outliers, which can be problematic if not addressed (Ledger et al. 2023; Leung et al. 2020; Buckland et al. 2011). The C-LPI does not currently remove outliers beyond the capping that’s currently built into the rlpi package. This step limits interannual change values (i.e., lambdas) to 1/-1, corresponding to a 10-fold increase or decline in abundance since the previous year — which recognizes large changes, but constrains their extent to a biologically plausible threshold. Here we explore three alternatives with removals at equal intervals:
a.	Removing 5% of the most extreme logged interannual change values (species lambdas) on either side of the distribution (lower and upper extremes). 
b.	Removing 10% of the most extreme logged interannual change values (species lambdas) on either side of the distribution (lower and upper extremes). 
c.	Removing 15% of the most extreme logged interannual change values (species lambdas) on either side of the distribution (lower and upper extremes). 

We also explore removal of species lambda outliers from only the lower or upper extremes of the index for investigative purposes in alignment with Leung et al. (2020; see Supplementary Material) but caution that the removal of only extreme positives or declines introduces substantial bias for the interpretation of results.

(vi) Weighting species
The data underlying the C-LPI are the result of 10 years of iterative data collection and cover approximately half of native vertebrate species (CESCC 2022) in Canada. The dataset is still continuously augmented, improving the taxonomic and spatial representation of the index for each subsequent iteration. However, gaps for species, habitats and geographies remain and should be accounted for to address potential biases of the collected data. Tackling taxonomic and ecosystem bias in the indicator may improve its representativeness (McRae et al. 2017) but could also reinforce potential biases within the dataset (e.g. where species with poor-quality data are weighted more heavily within the index). Here we explore one alternative to an unweighted index that includes proportional weighting by species richness. The proportion of known native species was taken from the 2020 Wild Species Report (CESCC 2022) and used to assign a weight for each taxon (Table S1). This approach differs to McRae et al. 2017, as we did not include a secondary weighting of equal distribution among systems (i.e., freshwater, marine and terrestrial) for two reasons: (i) there were limited data for some taxonomic/systems groups such as marine herptiles, where data was only available for one species, and (ii) a lack of ecological rationale for equal weightings among systems. 

(vii) Baseline year
The baseline year influences the final calculation of the geometric mean. Importantly, the C-LPI (and the global LPI) is a relative measure, comparing trends to the baseline year of 1970. Therefore, any shift in the baseline year may result in differing overall average trends. Critically, 1970 has the fewest time series records, and thus selection of a year with more data records could theoretically be more accurate. Yet, shifting the baseline has an impact on the temporal length of the index and the longer-term conclusions that can be drawn. 
a.	Here, we explore differences in indices and average trends associated with shifting the baseline year at five-year increments from 1970 to 2015, while retaining the current dataset (i.e. time series that span the chosen baseline will still contribute to the index with the interpolated and actual data points available from the chosen baseline onwards). 
